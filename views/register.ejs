<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Sign Up</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/Customizable-Background--Overlay.css">
    <link rel="stylesheet" href="/css/Footer-Dark-icons.css">
    <link rel="stylesheet" href="/css/Login-Form-Basic-icons.css">
    <link rel="stylesheet" href="/css/Profile-with-data-and-skills.css">
    <link rel="stylesheet" href="/css/Soft-UI-Aside-Navbar.css">
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/register.css">
    <link rel="stylesheet" href="/css/buttons.css">

    <script src="https://unpkg.com/axios@1.4.0"></script>
    <script src="https://unpkg.com/vue@next"></script>
</head>

<body>
    <!-- Start: Login Form Basic -->
    <section class="py-4 py-xl-5" style="padding-bottom: 15px;">
        <!-- Start: Customizable Background & Overlay -->
        <div style="background-image: url(&quot;/img/books.jpg&quot;);height: 1151px;background-position: center;background-size: cover;background-repeat: no-repeat;margin-top: -48px;padding-bottom: 0px;">
            <!-- Start: Overlay -->
            <div class="d-flex justify-content-center align-items-center" style="height: inherit;min-height: initial;width: 100%;position: absolute;left: 0;background: rgba(62,50,18,0.53);padding-bottom: 0px;">
                <!-- Start: 2 Rows 1+1 Columns -->
                <div class="container" id="app">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <h2 style="text-align: center;color: var(--bs-white);font-size: 36.44px;font-weight: bold;">Sign Up</h2>
                            <br>
                            <div class="card mb-5" style="background-color: rgba(255,255,255,0.16);">
                                <div class="card-body">
                                    <!-- Start: Sign Up Form - Gabriela Carvalho -->
                                    <form @submit.prevent="submitForm">
                                            <div class="row">
                                                <div class="col">
                                                    <label class="form-label fw-bold " >Username</label>
                                                    <input class="input" type="text" placeholder="Enter Username" v-model="username" required="">

                                                    <label class="form-label fw-bold">Password</label>
                                                    <input class="input" type="password" placeholder="Enter Password" v-model="password" required="">

                                                    <label class="form-label fw-bold">Repeat Password</label>
                                                    <input class="input" type="password" placeholder="Repeat Password" v-model="passwordRepeat" required="">

                                                    <label class="form-label fw-bold">Email</label>
                                                    <input class="input" type="email" placeholder="Enter Email" v-model="email" required="">

                                                    <label class="form-label fw-bold">Account Type</label>
                                                    <div class="dropdown">
                                                        <select class="input" v-model="type">
                                                            <option selected disabled value="">Enter Type</option>
                                                            <option value="student">Student</option>
                                                            <option value="teacher">Teacher</option>
                                                            <option value="manager">Manager</option>
                                                          </select>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <label class="form-label fw-bold">Full Name</label>
                                                    <input class="input" type="text" placeholder="Enter Full Name" v-model="real_name" required="">
                                                    
                                                    <label class="form-label fw-bold">Address</label>
                                                    <input class="input" type="text" placeholder="Enter Address" v-model="address" required="">
                                                    
                                                    <label class="form-label fw-bold">Phone Number</label>
                                                    <input class="input" type="text" placeholder="Enter Phone" v-model="phone" required="">
                                                    
                                                    <label class="form-label fw-bold">Date of Birth</label>
                                                    <input class="input" class="form-control" type="date" v-model="date_of_birth">
                                                    
                                                    <label class="form-label fw-bold">School</label>
                                                    <div class="dropdown">
                                                        <select class="input" v-model="school_id">
                                                            <option selected disabled value="">Select School</option>
                                                            <% schools.forEach(school => { %>
                                                                <option value=<%=school.id%>><%= school.name %></option>
                                                                <%}) %>
                                                          </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <p style="color:rgb(167, 165, 165)">Please fill in this form to apply for an account. Manager approval is still needed.</p>
                                            <p style="color: var(--bs-red)">{{ message }}</p>
                                            <p style="color: var(--bs-red)">{{ error }}</p>
                                            <div class="d-flex"><button class="btn btn-danger" type="button" @click="cancel">Cancel</button><button class="btn btn-primary" type="submit">Sign Up</button></div>
                                    </form><!-- End: Sign Up Form - Gabriela Carvalho -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div><!-- End: 2 Rows 1+1 Columns -->
            </div><!-- End: Overlay -->
        </div><!-- End: Customizable Background & Overlay -->
        <!-- Start: Footer Clean -->
        <footer class="text-center py-4">
            <div class="container">
                <div class="row row-cols-1 row-cols-lg-3">
                    <div class="col">
                        <p class="text-muted my-2">Databases Project: Team 92</p>
                    </div>
                    <div class="col"></div>
                    <div class="col">
                        <ul class="list-inline my-2">
                            <li class="list-inline-item"><a class="link-secondary" href="#">Privacy Policy</a></li>
                            <li class="list-inline-item"><a class="link-secondary" href="#">Terms of Use</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer><!-- End: Footer Clean -->
    </section><!-- End: Login Form Basic -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    username: '',
                    password: '',
                    passwordRepeat: '',
                    real_name: '',
                    email: '',
                    phone: '',
                    address: '',
                    date_of_birth: '',
                    type: '',
                    school_id: '',
                    error: '',
                    message: ''
                };
            },
            methods: {
                submitForm() {
                    if (this.password !== this.passwordRepeat) {
                        this.error = 'Passwords do not match';
                        return;
                    }
                    // Handle form submission logic here
                    const params = new URLSearchParams();
                    params.append('username', this.username);
                    params.append('password', this.password);
                    params.append('passwordRepeat', this.passwordRepeat);
                    params.append('real_name', this.real_name);
                    params.append('email', this.email);
                    params.append('phone', this.phone);
                    params.append('address', this.address);
                    params.append('date_of_birth', this.date_of_birth);
                    params.append('type', this.type);
                    params.append('school_id', this.school_id);
                    axios.post('http://localhost:3000/register', params)
                        .then(response => {
                            this.message = response.data;
                        })
                        .catch(error => {
                            // Handle error
                            this.error = error.response.data;
                        });
                },
                cancel() {
                    window.location.href = '/';
                }
            }
        });

        app.mount('#app');
    </script>
</body>

</html>